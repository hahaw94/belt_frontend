# 🚨 OBS连接问题临时修复方案

## 问题诊断
- ✅ Node.js依赖已安装
- ❌ **FFmpeg未安装**（这是主要问题）
- ❌ RTMP服务器无法启动

## 🔧 立即修复步骤

### 第一步：快速安装FFmpeg

#### 选项A：使用Chocolatey（推荐）
1. 以**管理员身份**打开PowerShell
2. 执行以下命令安装Chocolatey：
```powershell
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
```
3. 安装FFmpeg：
```powershell
choco install ffmpeg
```

#### 选项B：手动安装（如果Chocolatey失败）
1. 下载：https://www.gyan.dev/ffmpeg/builds/
2. 选择 "ffmpeg-release-essentials.zip"
3. 解压到 `C:\ffmpeg`
4. 添加 `C:\ffmpeg\bin` 到系统PATH环境变量
5. **重启命令行**

### 第二步：验证FFmpeg安装
```bash
ffmpeg -version
```
应该看到版本信息，不是错误。

### 第三步：启动RTMP服务器
```bash
cd belt
node rtmp-server.js
```
应该看到：
```
RTMP服务器已启动:
- RTMP推流地址: rtmp://localhost:1935/live/
- HTTP服务地址: http://localhost:8000/
```

### 第四步：配置OBS
1. 推流设置：
   - 服务：自定义
   - 服务器：`rtmp://localhost:1935/live`
   - 推流密钥：`camera1`

2. 点击"开始推流"

## 🔍 故障排除

### 如果FFmpeg安装后仍然报错
1. **完全关闭**所有命令行窗口
2. **重启电脑**（确保PATH生效）
3. 重新打开命令行测试

### 如果RTMP服务器启动失败
检查错误信息：
- `Error: spawn ffmpeg ENOENT` → FFmpeg未正确安装
- `EADDRINUSE` → 端口被占用
- `Permission denied` → 需要管理员权限

### 如果OBS仍然无法连接
1. 确认RTMP服务器正在运行
2. 检查Windows防火墙设置
3. 确认推流地址和密钥正确

## 📞 需要帮助？
如果按照上述步骤仍然无法解决，请提供：
1. FFmpeg版本信息
2. RTMP服务器启动时的完整输出
3. OBS的错误截图

## ⚡ 快速测试命令
安装完FFmpeg后，依次执行：
```bash
# 1. 测试FFmpeg
ffmpeg -version

# 2. 启动服务器
cd belt
node rtmp-server.js

# 3. 在新命令行窗口测试端口
netstat -an | findstr :1935
```

如果都正常，就可以在OBS中开始推流了！
